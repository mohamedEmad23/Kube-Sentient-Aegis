# vCluster template for AEGIS Shadow Environments
# This template creates isolated virtual Kubernetes clusters for fix verification
#
# Usage by AEGIS:
#   1. Create shadow: vcluster create shadow-{incident_id} -n aegis-shadows -f vcluster-template.yaml
#   2. Connect: vcluster connect shadow-{incident_id} -n aegis-shadows
#   3. Clone workloads and apply fixes
#   4. Run verification tests
#   5. Cleanup: vcluster delete shadow-{incident_id} -n aegis-shadows

# vCluster configuration
# NOTE: sync settings are omitted for compatibility with newer vcluster schemas.

# Note: The "isolation" block was removed for vcluster v0.20+ compatibility.
# If you need quotas/limits, configure them via policies or apply them after
# vcluster creation with standard Kubernetes objects.

# Control plane configuration
controlPlane:
  # Use k3s as the control plane (lightweight)
  distro:
    k3s:
      enabled: true

  # Resource limits for vCluster control plane
  statefulSet:
    resources:
      requests:
        cpu: "100m"
        memory: "256Mi"
      limits:
        cpu: "500m"
        memory: "512Mi"

    # Faster startup for demos
    persistence:
      volumeClaim:
        enabled: false  # Use emptyDir for faster creation

# Networking
networking:
  # Replicate services between host and vCluster
  replicateServices:
    toHost: []
    fromHost: []

# Policies
policies:
  # Pod security standards
  podSecurityStandard: baseline

  # Resource quota (disabled by default)
  resourceQuota:
    enabled: false

# Telemetry (disable for privacy)
telemetry:
  enabled: false

# Export kubeconfig
exportKubeConfig:
  # Make kubeconfig available as secret
  secret:
    name: "vc-shadow-kubeconfig"

# Labels/annotations omitted for compatibility with older vcluster config schema.
